---
import Layout from '../layouts/Layout.astro';
import fs from 'node:fs/promises';
import __dirname from '../../__dirname';
import path from 'path';

const dataDir = path.join(__dirname, 'data');
const content = await fs.readFile(path.join(dataDir, 'conferences.json'));
const conferences = JSON.parse(content);
---

<Layout>
	<main>
        <div class="container-fluid">
            <div class="container">
                <h1>
                    { conferences.length } conférences organisées par les communautés du LyonTechHub<br />
                    <small><a href="/about">Par ici pour référencer la votre !</a></small>
                </h1>
                Rechercher :
                <input type="text" id="filterConferences" onkeyup="dynamicFilter('filterConferences')">
                <div class="row communitiesList">
                    {conferences
                        .map(
                            (conference) => (
                                <div class="col-sm-12 col-md-12 filterable" key={conference.name}>
                                    <div class="thumbnail">
                                          <a href={conference.url} target="_blank">
                                            <img src={"/imgs/conferences/" + conference.image} onerror="this.onerror=null;this.src='/imgs/noLogo.png';" />
                                          </a>
                                        <div class="caption">
                                            <h3>{conference.name}</h3>
                                            <p>{conference.shortDescription}
                                        </div>
                                    </div>
                                </div>
                            )
                        )
                    }
                </div>
            </div>
        </div>
	</main>
</Layout>
